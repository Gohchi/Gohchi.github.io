<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="overflow: hidden">

<style>


 ul {
    list-style: none;
    padding: 0;
}
 /*
canvas {
    border: solid 1px gray;
    float: left;
    margin-right: 20px;
}

label {
    padding: 2px 8px;
    border: solid 1px silver;
    margin: 2px;
    background: rgb(245, 245, 245);
    display: inline-block;
}

span {
    font-weight: bold;
    margin-left: 5px;
}*/

</style>
<body style="width:100px">
<ul><li>
<!--canvas id="miCanvas" width="224px" height="80px">
 <span>Tu explorador es anciano, renovalo si queres ver la magia</span>
</canvas-->
</li><li>
 <canvas id="miCanvasIT"  width="223px" height="266px">
 <span>Tu explorador es anciano, renovalo si queres ver la magia</span>
</canvas> 
 </li> </ul>
 </body>
 <script src="js/Menu.js"></script> 
 <script src="js/Dialog.js"></script> 
  <script src="js/CharaSprite.js"></script>
  <script src="js/Objects.js"></script> 
 <script src="js/keyboard.js"></script> 
<script src="js/common.js"></script> 
 <script src="js/Weapon.js"></script> 
 <script src="js/haku.js"></script> 
 <script src="js/hit.js"></script> 
 <script src="js/Slider.js"></script> 
 <!--Maple-->
 <script src="js/MS_Menu.js"></script> 
<script>

var c = document.getElementById('miCanvasIT');
var ctxppal = c.getContext('2d'); 
 
ctxppal.roundedRect = roundedRect; 
ctxppal.roundedStrokeRect = roundedStrokeRect;
ctxppal.roundedFillRect = roundedFillRect;

var MSmnuInfo = new MS_Menu(ctxppal);
MSmnuInfo.moveTo(65,5);
MSmnuInfo.resize(155,60);
var date = new Date();

var haku = new haku();
haku.wpn.parent = haku;
haku.ctx = ctxppal;
var bar = new slider();
bar.ctx = ctxppal;
var hit = new hit();
hit.ctx = ctxppal;

var health = 100;
var dmghit;

var xx = 100, yy = 80;
var qx = 0, qy = 0; 

hero.ctx = ctxppal;
mob.ctx = ctxppal;
 
window.onload = function(){
  loop();
}
function loop(){
 
 var dir = 0;
 var w = 60, h = 10;
 var x = 1, y=10, x2=1, m=1.1;
 var pxpfx2=0, lastx2=1;
 window.setInterval(function(){
  
  drawBackground();
 
 
 MSmnuInfo.min = dayHour;//getMin();
 if(lastSec!=0&&getSec()==0)
  dayHour++;
  
 if(dayHour>2) dayHour = 0;
  lastSec = parseInt(getSec());
 MSmnuInfo.sec = lastSec;
 var t = {
  ctx:ctxppal
  ,x:120
  ,y:120
 };
 
  
if(playing){
 
  bar.draw();
  hero.draw();
  mob.draw();
     
 haku.draw();
 var objx = {
  x:(bar.x+bar.vx),
  y:(bar.y+bar.vy), 
  w:bar.w,
  h:bar.h
 };
 var r1 = intToHex(random(15));
 var r2 = intToHex(random(15));
 var g1 = intToHex(random(15));
 var g2 = intToHex(random(15));
 var b1 = intToHex(random(15));
 var b2 = intToHex(random(15)); 
 if(haku.contact(objx)){ 
 /* bar.ctx.fillText(
   r1+'-'+g1+'-'+b1
   ,bar.x,bar.y
  ); */
  bar.color =
   '#'+r1+r2+g1+g2+b1+b2; 
 }
 if(xx<0) xx=0;
 if(xx+w>223) xx = 223-w; 

  if(haku.isOutBottom()){
   dmghit = Math.round(Math.random(10)*100);
   
   haku.contactAni(
    (dmghit>50)?1:0);
    
   hit.add(
    dmghit
 	,haku.x-10
 	,haku.y
 	,(dmghit>50)?1:0
 	); 
 	 
 	health-= dmghit;
  }

 if(health<0)health = 0;
 ctxppal.fillRect(
  10,10,health/3,5
 );
 
 if(health==0){
  playing = false;
  health = 600;
  mnu.selected = false;
 } 
 
  drawLife(hero, ctxppal
   , 10, 20);
  drawLife(mob, ctxppal
   , 10, 40); 
 }else{
  
   
   /*
  if(!isNaN(lLastDmgMob)){
   ctxppal.fillStyle = 'red';
  }else{
   ctxppal.fillStyle = 'black';
  }
  ctxppal.fillText(
   lLastDmgMob,  10, 50);
    
  if(!isNaN(lLastDmgHero)){
   ctxppal.fillStyle = 'red';
  }else{
   ctxppal.fillStyle = 'black';
  } 
  ctxppal.fillText(
   lLastDmgHero, 80, 50);  
  */
  mnu.draw();
  
 ctxppal.save();
 
 ////////////////////////////
 // BEGIN AREA TEST /////////
 //////////////////////////// 
 var qx1 = 100+qx;
 var qy1 = 150+qy;
 t.ctx.fillStyle = '#FF0000';
 t.ctx.fillRect(
  qx1-2,qy1-2,4,4);
 t.ctx.beginPath();  
 t.ctx.moveTo(50,80);
 t.ctx.quadraticCurveTo(
  qx1,qy1, 150,80
 );
 
  
 //t.ctx.closePath();
 t.ctx.stroke();
 
 
 MSmnuInfo.draw();
 
 ////////////////////////////
 // END AREA TEST ///////////
 ////////////////////////////
 ctxppal.restore(); 
 }
 
 hit.draw(); 
 },10); 
}

//Create menues
var mnu = new Menu(10, 20);
mnu.add('Start'); 
mnu.add('Options');//, true); 
mnu.add('Quit'); 
mnu.setRows(3); 
 

var mnuS = new Menu(80, 50);
//mnuS.add('BG Color');
//mnuS.add('close'); 
mnuS.setRows(2);

//var mnuBG = new Menu(80,70);
mnuS.add('Plane');
mnuS.add('Linear');
mnuS.add('Radial');
mnuS.add('DayTime');
mnuS.add('close'); 
//mnuBG.setRows(3); 

mnu.setAction(0, 'functionX', '');
mnu.setAction(1, 'child',mnuS);
mnu.setAction(2, 'alert','exit');

 
//mnuS.setAction(0,'child', mnuBG); 
//mnuS.setAction(1,'action', 'close'); 

mnuS.setAction(0,'function0',' setGradientMode(0)'); 
mnuS.setAction(1,'function1',' setGradientMode(1)'); 
mnuS.setAction(2,'function2',' setGradientMode(2)'); 
mnuS.setAction(3,'function3',' setGradientMode(3)'); 
mnuS.setAction(4,'action', 'close');


//---------------------------

//Create Dialogs
var dlg = new Dialog(15, 80);
dlg.add('some text and some more for a while...');

function drawBackground(){
  var canvasIT = document.getElementById('miCanvasIT');
  var ctxIT = canvasIT.getContext('2d');
  //ctxIT.save();
  ctxIT.globalAlpha = 0.2;
  ctxIT.font = 'bold 18px Comic Sans MS';

ctxIT.fillStyle = crazyGradient(canvasIT);
 // ctxIT.fillStyle = '#FFF';
  ctxIT.fillRect(0, 0, canvasIT.width, canvasIT.height); 
  ctxIT.globalAlpha = 1; 

  ctxIT.fillStyle = 'black'; 
  
  ctxIT.lineWidth = 1;
  ctxIT.strokeStyle = 'black';
  ctxIT.strokeRect(
   0, 0, canvasIT.width
   ,canvasIT.height
  );
  
 mnu.setCtx(ctxIT); 
}

function instantText(text, textLine){
}

function dibujar(){
 //hero.initBaseStat(18); 
 
/*

var student1 = new Student();
student1.sayHello();
student1.walk();
student1.sayGoodBye();

// check inheritance
alert(student1 instanceof Person); // true 
alert(student1 instanceof Student); // true
   */ 
    
    
    
    var canvas = document.getElementById('miCanvas');
    var ctx = canvas.getContext('2d');
  
    ctx.save();

    ctx.fillStyle = '#F0DB4F';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.restore();
  
    ctx.lineWidth = 3;
    ctx.strokeStyle = 'black';
    ctx.strokeRect(1, 1, canvas.width-2, canvas.height-2);

    ctx.save();
  
    ctx.scale(1.8, 2.4);  
      
    ctx.fillStyle = '#333';
    ctx.font = 'bold 45px Comic Sans MS';
    ctx.textBaseline = 'top';
   // ctx.fillText('...', 2, 5);
    
    ctx.restore();
/* 
    var vaso = new Image();
    vaso.onload = function() {
      ctx.drawImage(vaso, 0, 0);
    };
    vaso.src = "glassup.png";
*/
    ctx.fillStyle = 'black';
    /*
    ctx.beginPath();  
    ctx.moveTo(80,25);  
    ctx.lineTo(115,0);  
    ctx.lineTo(125,0);  
    ctx.closePath(); 
    ctx.fill(); 
    
    ctx.beginPath();  
    ctx.moveTo(100,50);  
    ctx.lineTo(223,75);  
    ctx.lineTo(223,80);  
    ctx.closePath();
    ctx.fill(); 
    
    ctx.beginPath();  
    ctx.moveTo(25,35);  
    ctx.lineTo(0,50);  
    ctx.lineTo(0,55);  
    ctx.closePath();
    ctx.fill(); 
    
    ctx.beginPath();  
    ctx.moveTo(25,55);  
    ctx.lineTo(0,100);  
    ctx.lineTo(0,110);  
    ctx.closePath();
    ctx.fill(); 
    */
    
}

//dibujar(); 
//instantText();
</script>
</body>
</html>